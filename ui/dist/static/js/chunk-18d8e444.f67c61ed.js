(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18d8e444"],{"0afc":function(e,t,o){"use strict";var a=o("629b"),r=o.n(a);r.a},"629b":function(e,t,o){},7146:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("clusterbar",{attrs:{titleName:e.titleName,nameFunc:e.nameSearch,createFunc:e.openCreateFormDialog,createDisplay:"创建空间"}}),o("div",{ref:"tableCot",staticClass:"dashboard-container"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"table-fix",staticStyle:{width:"100%"},attrs:{data:e.originWorkspaces,"cell-style":e.cellStyle,"default-sort":{prop:"name"},"tooltip-effect":"dark"}},[o("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":"","min-width":"15"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{staticClass:"name-class",on:{click:function(o){return e.nameClick(t.row.id)}}},[e._v(" "+e._s(t.row.name)+" ")])]}}])}),o("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":"","min-width":"15"}}),o("el-table-column",{attrs:{prop:"cluster_id",label:"绑定集群","show-overflow-tooltip":"","min-width":"15"}}),o("el-table-column",{attrs:{prop:"namespace",label:"命名空间","show-overflow-tooltip":"","min-width":"15"}}),o("el-table-column",{attrs:{prop:"owner",label:"负责人","show-overflow-tooltip":"","min-width":"10"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.owner)+" ")]}}])}),o("el-table-column",{attrs:{prop:"update_time",label:"更新时间","show-overflow-tooltip":"","min-width":"15"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$dateFormat(t.row.update_time))+" ")]}}])}),o("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",{staticClass:"tableOperate"},[o("el-link",{staticStyle:{"margin-right":"13px",color:"#409EFF"},attrs:{underline:!1},on:{click:function(o){return e.nameClick(t.row.id)}}},[e._v("详情")]),o("el-link",{staticStyle:{"margin-right":"13px",color:"#409EFF"},attrs:{underline:!1},on:{click:function(o){return e.openUpdateFormDialog(t.row)}}},[e._v("编辑")]),o("el-link",{staticStyle:{color:"#F56C6C"},attrs:{underline:!1},on:{click:function(o){return e.handleDeleteWorkspace(t.row.id,t.row.name)}}},[e._v("删除")])],1)]}}])})],1),o("el-dialog",{attrs:{title:e.updateFormVisible?"修改空间":"创建空间",visible:e.createFormVisible,"destroy-on-close":!0},on:{"update:visible":function(t){e.createFormVisible=t},close:e.closeFormDialog}},[o("div",{staticClass:"dialogContent"},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"left","label-width":"105px"}},[o("el-form-item",{attrs:{label:"名称",prop:"name",autofocus:""}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入空间名称",size:"small"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"描述",prop:"description"}},[o("el-input",{attrs:{type:"textarea",autocomplete:"off",placeholder:"请输入空间描述",size:"small"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),o("el-form-item",{attrs:{label:"集群",prop:"",required:!0}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择要绑定的集群",size:"small",disabled:e.updateFormVisible},on:{change:e.fetchNamespace},model:{value:e.form.cluster_id,callback:function(t){e.$set(e.form,"cluster_id",t)},expression:"form.cluster_id"}},e._l(e.clusters,(function(e){return o("el-option",{key:e.name,attrs:{label:e.name,value:e.name,disabled:"Connect"!=e.status}})})),1)],1),o("el-form-item",{attrs:{label:"命名空间",prop:"",required:!0}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择要绑定的命名空间",size:"small",disabled:e.updateFormVisible},model:{value:e.form.namespace,callback:function(t){e.$set(e.form,"namespace",t)},expression:"form.namespace"}},e._l(e.namespaces,(function(e){return o("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})})),1)],1),o("el-form-item",{attrs:{label:"负责人",prop:"",required:!0}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入该项目空间负责人",size:"small"},model:{value:e.form.owner,callback:function(t){e.$set(e.form,"owner",t)},expression:"form.owner"}})],1)],1)],1),o("div",{staticClass:"dialogFooter",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{"margin-right":"20px"},on:{click:function(t){e.createFormVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.updateFormVisible?e.handleUpdateWorkspace():e.handleCreateWorkspace()}}},[e._v("确 定")])],1)])],1)],1)},r=[],n=(o("a4d3"),o("e01a"),o("4de4"),o("c975"),o("b0c0"),o("b85c")),s=o("61b2"),i=o("4fee"),l=o("7ea2"),c=o("aad4"),m=o("5c96"),u={name:"workspace",components:{Clusterbar:s["a"]},mounted:function(){var e=this;window.onresize=function(){return function(){var t=window.innerHeight-135;e.maxHeight=t}()}},data:function(){return{maxHeight:window.innerHeight-135,cellStyle:{border:0},titleName:["工作空间"],loading:!0,createFormVisible:!1,updateFormVisible:!1,clusters:[],namespaces:[],form:{id:"",name:"",description:"",cluster_id:"",namespace:"",owner:""},rules:{name:[{required:!0,message:"请输入空间名称",trigger:"blur"}]},originWorkspaces:[],search_name:"",secretTypeMap:{password:"密码",key:"密钥",token:"AccessToken"}}},created:function(){this.fetchWorkspaces()},computed:{secrets:function(){}},methods:{nameClick:function(e){this.$router.push({name:"workspaceOverview",params:{workspaceId:e}})},handleEdit:function(e,t){console.log(e,t)},fetchWorkspaces:function(){var e=this;this.loading=!0,Object(i["b"])().then((function(t){e.originWorkspaces=t.data?t.data:[],e.loading=!1})).catch((function(t){console.log(t),e.loading=!1}))},handleCreateWorkspace:function(){var e=this;if(this.form.name)if(this.form.cluster_id)if(this.form.namespace){var t={name:this.form.name,description:this.form.description,cluster_id:this.form.cluster_id,namespace:this.form.namespace,owner:this.form.owner};Object(i["a"])(t).then((function(){e.createFormVisible=!1,m["Message"].success("创建项目空间成功"),e.fetchWorkspaces()})).catch((function(e){console.log(e)}))}else m["Message"].error("请选择要绑定的集群命名空间");else m["Message"].error("请选择要绑定的集群");else m["Message"].error("空间名称不能为空")},handleUpdateWorkspace:function(){var e=this;if(this.form.id){var t={name:this.form.name,description:this.form.description,owner:this.form.owner};updateSecret(this.form.id,t).then((function(){e.createFormVisible=!1,m["Message"].success("更新项目空间成功"),e.fetchWorkspaces()})).catch((function(e){console.log(e)}))}else m["Message"].error("获取空间id参数异常，请刷新重试")},handleDeleteWorkspace:function(e,t){var o=this;e?this.$confirm("请确认是否删除「".concat(t,"」此项目空间?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){deleteSecret(e).then((function(){m["Message"].success("删除项目空间成功"),o.fetchWorkspaces()})).catch((function(e){console.log(e)}))})).catch((function(){})):m["Message"].error("获取密钥id参数异常，请刷新重试")},nameSearch:function(e){this.search_name=e},fetchClusters:function(){var e=this;this.namespaces=[],Object(l["g"])().then((function(t){e.clusters=t.data||[]})).catch((function(){}))},fetchNamespace:function(){var e=this;this.namespaces=[];var t=this.form.cluster_id;t?Object(c["b"])(t).then((function(t){e.namespaces=t.data,e.namespaces.sort((function(e,t){return e.name>t.name?1:-1}));var o=storage.get(e.nsKey);if(o){var a,r=[],s=Object(n["a"])(e.namespaces);try{for(s.s();!(a=s.n()).done;){var i=a.value;r.push(i.name)}}catch(c){s.e(c)}finally{s.f()}var l=o.filter((function(e){return r.indexOf(e)>-1}));e.nsInput=l,e.nsFunc&&e.nsFunc(e.nsInput)}})).catch((function(e){console.log(e)})):m["Message"].error("获取集群异常，请刷新重试")},openCreateFormDialog:function(){this.createFormVisible=!0,this.fetchClusters()},openUpdateFormDialog:function(e){this.form={id:e.id,name:e.name,description:e.description,cluster_id:e.cluster_id,namespace:e.namespace,owner:e.owner},this.updateFormVisible=!0,this.createFormVisible=!0},closeFormDialog:function(){this.form={name:"",description:"",cluster_id:"",namespace:"",owner:""},this.updateFormVisible=!1,this.createFormVisible=!1}}},f=u,p=(o("0afc"),o("2877")),d=Object(p["a"])(f,a,r,!1,null,"990f51bc",null);t["default"]=d.exports}}]);