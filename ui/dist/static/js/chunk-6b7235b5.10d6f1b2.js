(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b7235b5"],{"2ad9":function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var i=n("b775");function o(e){return Object(i["a"])({url:"pipeline/pipeline",method:"get",params:{workspace_id:e}})}function r(e){return Object(i["a"])({url:"pipeline/pipeline/".concat(e),method:"get"})}function a(e){return Object(i["a"])({url:"pipeline/pipeline",method:"put",data:e})}function l(e){return Object(i["a"])({url:"pipeline/pipeline",method:"post",data:e})}function c(e){return Object(i["a"])({url:"pipeline/pipeline/".concat(e),method:"delete"})}},3689:function(e,t,n){"use strict";var i=n("5886"),o=n.n(i);o.a},5886:function(e,t,n){},"9c62":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("clusterbar",{attrs:{titleName:e.titleName,nameFunc:e.nameSearch,createFunc:e.createPipelineFunc,createDisplay:"创建流水线"}}),n("div",{ref:"tableCot",staticClass:"dashboard-container"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-fix",staticStyle:{width:"100%"},attrs:{data:e.pipelines,"tooltip-effect":"dark","max-height":e.maxHeight,"cell-style":e.cellStyle,"default-sort":{prop:"name"},"row-key":"name"}},[n("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"name-class",on:{click:function(n){return e.nameClick(t.row.pipeline.id)}}},[e._v(" "+e._s(t.row.pipeline.name)+" ")])]}}])}),n("el-table-column",{attrs:{prop:"create_time",label:"最新构建","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.last_build?n("span",{style:{color:e.getBuildStatusColor(t.row.last_build.status)}},[n("i",{class:e.getBuildStatusIcon(t.row.last_build.status),staticStyle:{"font-size":"16px"}}),e._v(" "+e._s(t.row.last_build?"#"+t.row.last_build.build_number:"无")+" ")]):e._e()]}}])}),n("el-table-column",{attrs:{prop:"create_time",label:"构建分支","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(" "+e._s(e.getBuildBranch(t.row.last_build)||"—")+" ")])]}}])}),n("el-table-column",{attrs:{prop:"create_time",label:"最新构建时间","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(" "+e._s(t.row.last_build?e.$dateFormat(t.row.last_build.create_time):"")+" ")])]}}])}),n("el-table-column",{attrs:{prop:"create_time",label:"触发人","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(" "+e._s(t.row.last_build?t.row.last_build.operator:"")+" ")])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"tableOperate"},[n("el-link",{staticStyle:{"margin-right":"15px",color:"#409EFF"},attrs:{underline:!1},on:{click:function(n){return e.nameClick(t.row.id)}}},[e._v("构建")]),n("el-link",{staticStyle:{"margin-right":"15px",color:"#409EFF"},attrs:{underline:!1},on:{click:function(n){return e.editPipelineOperate(t.row.pipeline.id)}}},[e._v("编辑")]),n("el-link",{staticStyle:{color:"#F56C6C"},attrs:{underline:!1},on:{click:function(n){return e.handleDeletePipeline(t.row.pipeline.id,t.row.pipeline.name)}}},[e._v("删除")])],1)]}}])})],1)],1)],1)},o=[],r=n("61b2"),a=n("2ad9"),l=n("5c96"),c={name:"PipelineWorkspace",components:{Clusterbar:r["a"]},data:function(){return{titleName:["流水线"],search_name:"",users:[],cellStyle:{border:0},maxHeight:window.innerHeight-150,loading:!0,pipelines:[],createClusterFormVisible:!1,inviteForm:!1,clusterConnectDialog:!1,clusterConnectToken:"",form:{name:"",members:[]},locationAddr:window.location.origin}},created:function(){this.fetchData()},mounted:function(){var e=this;window.onresize=function(){return function(){var t=window.innerHeight-150;console.log(t),e.maxHeight=t}()}},computed:{workspaceId:function(){return this.$route.params.workspaceId}},methods:{fetchData:function(){var e=this;this.loading=!0,Object(a["d"])(this.workspaceId).then((function(t){e.loading=!1,e.pipelines=t.data||[]})).catch((function(){e.loading=!1}))},nameClick:function(e){this.$router.push({name:"pipelineBuilds",params:{pipelineId:e}})},nameSearch:function(e){this.search_name=e},getBuildBranch:function(e){if(e){var t="",n="";return e.env&&e.env.PIPELINE_CODE_BRANCH&&(t=e.env.PIPELINE_CODE_BRANCH),t?(e.env&&e.env.PIPELINE_CODE_COMMIT_AUTHOR&&(n=e.env.PIPELINE_CODE_COMMIT_AUTHOR),t+(n?" ("+n+")":"")):""}return""},createPipelineFunc:function(){this.$router.push({name:"pipelineCreate"})},editPipelineOperate:function(e){this.$router.push({name:"pipelineEdit",params:{pipelineId:e}})},getBuildStatusColor:function(e){return"ok"==e?"#67c23a":"error"==e?"#DC143C":"doing"==e?"#E6A23C":""},getBuildStatusIcon:function(e){return"ok"==e?"el-icon-success":"error"==e?"el-icon-error":"doing"==e?"el-icon-refresh":"wait"==e?"el-icon-remove":""},handleDeletePipeline:function(e,t){var n=this;e?this.$confirm("请确认是否删除「".concat(t,"」此流水线以及所有构建?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(a["b"])(e).then((function(){l["Message"].success("删除流水线成功"),n.fetchData()})).catch((function(e){console.log(e)}))})).catch((function(){})):l["Message"].error("获取流水线id参数异常，请刷新重试")}}},u=c,s=(n("3689"),n("2877")),p=Object(s["a"])(u,i,o,!1,null,"a5ad772c",null);t["default"]=p.exports}}]);