(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33e25bfd"],{7146:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("clusterbar",{attrs:{titleName:e.titleName,nameFunc:e.nameSearch,createFunc:e.openCreateFormDialog,createDisplay:"创建空间"}}),o("div",{ref:"tableCot",staticClass:"dashboard-container"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"table-fix",staticStyle:{width:"100%"},attrs:{data:e.originWorkspaces,"cell-style":e.cellStyle,"default-sort":{prop:"name"},"tooltip-effect":"dark"}},[o("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":"","min-width":"15"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{staticClass:"name-class",on:{click:function(o){return e.nameClick(t.row.id)}}},[e._v(" "+e._s(t.row.name)+" ")])]}}])}),o("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":"","min-width":"15"}}),o("el-table-column",{attrs:{prop:"cluster_id",label:"绑定集群","show-overflow-tooltip":"","min-width":"15"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.cluster?t.row.cluster.name1:t.row.cluster_id)+" ")]}}])}),o("el-table-column",{attrs:{prop:"namespace",label:"命名空间","show-overflow-tooltip":"","min-width":"15"}}),o("el-table-column",{attrs:{prop:"owner",label:"负责人","show-overflow-tooltip":"","min-width":"10"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.owner)+" ")]}}])}),o("el-table-column",{attrs:{prop:"update_time",label:"更新时间","show-overflow-tooltip":"","min-width":"15"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$dateFormat(t.row.update_time))+" ")]}}])}),o("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",{staticClass:"tableOperate"},[o("el-link",{staticStyle:{"margin-right":"13px",color:"#409EFF"},attrs:{underline:!1},on:{click:function(o){return e.nameClick(t.row.id)}}},[e._v("详情")]),o("el-link",{staticStyle:{"margin-right":"13px"},attrs:{disabled:!e.$editorRole(t.row.id),underline:!1,type:"primary"},on:{click:function(o){return e.openUpdateFormDialog(t.row)}}},[e._v("编辑")]),o("el-link",{attrs:{disabled:!e.$adminRole(t.row.id),underline:!1,type:"danger"},on:{click:function(o){return e.handleDeleteWorkspace(t.row.id,t.row.name)}}},[e._v("删除")])],1)]}}])})],1),o("el-dialog",{attrs:{title:e.updateFormVisible?"修改空间":"创建空间",visible:e.createFormVisible,"destroy-on-close":!0},on:{"update:visible":function(t){e.createFormVisible=t},close:e.closeFormDialog}},[o("div",{staticClass:"dialogContent"},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"left","label-width":"105px"}},[o("el-form-item",{attrs:{label:"名称",prop:"name",autofocus:""}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入空间名称",size:"small"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"描述",prop:"description"}},[o("el-input",{attrs:{type:"textarea",autocomplete:"off",placeholder:"请输入空间描述",size:"small"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),o("el-form-item",{attrs:{label:"集群",prop:"",required:!0}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择要绑定的集群",size:"small",disabled:e.updateFormVisible},on:{change:e.fetchNamespace},model:{value:e.form.cluster_id,callback:function(t){e.$set(e.form,"cluster_id",t)},expression:"form.cluster_id"}},e._l(e.clusters,(function(e){return o("el-option",{key:e.name,attrs:{label:e.name1,value:e.name,disabled:"Connect"!=e.status}})})),1)],1),o("el-form-item",{attrs:{label:"命名空间",prop:"",required:!0}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择要绑定的命名空间",size:"small",disabled:e.updateFormVisible},model:{value:e.form.namespace,callback:function(t){e.$set(e.form,"namespace",t)},expression:"form.namespace"}},e._l(e.namespaces,(function(e){return o("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})})),1)],1),o("el-form-item",{attrs:{label:"负责人",prop:"",required:!0}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入该项目空间负责人",size:"small"},model:{value:e.form.owner,callback:function(t){e.$set(e.form,"owner",t)},expression:"form.owner"}})],1)],1)],1),o("div",{staticClass:"dialogFooter",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{"margin-right":"20px"},on:{click:function(t){e.createFormVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.updateFormVisible?e.handleUpdateWorkspace():e.handleCreateWorkspace()}}},[e._v("确 定")])],1)])],1)],1)},a=[],s=(o("a4d3"),o("e01a"),o("b0c0"),o("61b2")),i=o("4fee"),n=o("7ea2"),l=o("aad4"),c=o("5c96"),m={name:"workspace",components:{Clusterbar:s["a"]},mounted:function(){var e=this;window.onresize=function(){return function(){var t=window.innerHeight-135;e.maxHeight=t}()}},data:function(){return{maxHeight:window.innerHeight-135,cellStyle:{border:0},titleName:["工作空间"],loading:!0,createFormVisible:!1,updateFormVisible:!1,clusters:[],namespaces:[],form:{id:"",name:"",description:"",cluster_id:"",namespace:"",owner:this.$store.getters.username},rules:{name:[{required:!0,message:"请输入空间名称",trigger:"blur"}]},originWorkspaces:[],search_name:"",secretTypeMap:{password:"密码",key:"密钥",token:"AccessToken"}}},created:function(){this.fetchWorkspaces()},computed:{secrets:function(){}},methods:{nameClick:function(e){this.$router.push({name:"workspaceOverview",params:{workspaceId:e}})},handleEdit:function(e,t){console.log(e,t)},fetchWorkspaces:function(){var e=this;this.loading=!0,Object(i["d"])().then((function(t){e.originWorkspaces=t.data?t.data:[],e.loading=!1})).catch((function(t){console.log(t),e.loading=!1}))},handleCreateWorkspace:function(){var e=this;if(this.form.name)if(this.form.cluster_id)if(this.form.namespace)if(this.form.owner){var t={name:this.form.name,description:this.form.description,cluster_id:this.form.cluster_id,namespace:this.form.namespace,owner:this.form.owner};Object(i["a"])(t).then((function(){e.createFormVisible=!1,c["Message"].success("创建项目空间成功"),e.fetchWorkspaces()})).catch((function(e){console.log(e)}))}else c["Message"].error("空间负责人不能为空");else c["Message"].error("请选择要绑定的集群命名空间");else c["Message"].error("请选择要绑定的集群");else c["Message"].error("空间名称不能为空")},handleUpdateWorkspace:function(){var e=this;if(this.form.id){var t={name:this.form.name,description:this.form.description,owner:this.form.owner};this.form.name?this.form.owner?Object(i["f"])(this.form.id,t).then((function(){e.createFormVisible=!1,c["Message"].success("更新项目空间成功"),e.fetchWorkspaces()})).catch((function(e){console.log(e)})):c["Message"].error("空间负责人不能为空"):c["Message"].error("空间名称不能为空")}else c["Message"].error("获取空间id参数异常，请刷新重试")},handleDeleteWorkspace:function(e,t){var o=this;e?this.$confirm("请确认是否删除「".concat(t,"」此项目空间?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["b"])(e).then((function(){c["Message"].success("删除项目空间成功"),o.fetchWorkspaces()})).catch((function(e){console.log(e)}))})).catch((function(){})):c["Message"].error("获取密钥id参数异常，请刷新重试")},nameSearch:function(e){this.search_name=e},fetchClusters:function(){var e=this;this.namespaces=[],Object(n["g"])().then((function(t){e.clusters=t.data||[]})).catch((function(){}))},fetchNamespace:function(){var e=this;this.namespaces=[];var t=this.form.cluster_id;t?Object(l["b"])(t).then((function(t){e.namespaces=t.data,e.namespaces.sort((function(e,t){return e.name>t.name?1:-1}))})).catch((function(e){console.log(e)})):c["Message"].error("获取集群异常，请刷新重试")},openCreateFormDialog:function(){this.form={name:"",description:"",cluster_id:"",namespace:"",owner:this.$store.getters.username},this.createFormVisible=!0,this.fetchClusters()},openUpdateFormDialog:function(e){this.form={id:e.id,name:e.name,description:e.description,cluster_id:e.cluster_id,namespace:e.namespace,owner:e.owner},this.fetchClusters(),this.updateFormVisible=!0,this.createFormVisible=!0},closeFormDialog:function(){this.updateFormVisible=!1,this.createFormVisible=!1}}},u=m,d=(o("874e"),o("2877")),f=Object(d["a"])(u,r,a,!1,null,"78301e1a",null);t["default"]=f.exports},8646:function(e,t,o){},"874e":function(e,t,o){"use strict";var r=o("8646"),a=o.n(r);a.a}}]);